

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>无线上传及冷热插拔 &mdash; PROS for V5（中文） 3.1.6 文档</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

<link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  

  
        <link rel="index" title="索引"
              href="../../genindex.html"/>
        <link rel="search" title="搜索" href="../../search.html"/>
    <link rel="top" title="PROS for V5（中文） 3.1.6 文档" href="../../index.html"/>
        <link rel="up" title="教程" href="../index.html"/>
        <link rel="next" title="API 主页" href="../../api/index.html"/>
        <link rel="prev" title="视觉传感器" href="vision.html"/>
  
   
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> PROS for V5（中文）
          

          
            
            <img src="../../_static/logo.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                
                  V5 (3.1.6)
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">主页</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">PROS：文档主页</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/index.html">博客</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">版本发行说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">获得帮助</a></li>
</ul>
<p class="caption"><span class="caption-text">入门</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/new-users.html">PROS 初学者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation.html">安装指南</a></li>
</ul>
<p class="caption"><span class="caption-text">教程</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">教程</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#id3">常规教程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#id5">演练教程</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#id6">专题教程</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="adi.html">模拟数字接口（3 线端口）</a></li>
<li class="toctree-l3"><a class="reference internal" href="controller.html">手柄</a></li>
<li class="toctree-l3"><a class="reference internal" href="display.html">V5 Brain 显示屏（LVGL）</a></li>
<li class="toctree-l3"><a class="reference internal" href="filesystem.html">文件系统</a></li>
<li class="toctree-l3"><a class="reference internal" href="jinx.html">JINX 图形调试器</a></li>
<li class="toctree-l3"><a class="reference internal" href="llemu.html">LLEMU（传统 LCD 仿真器）</a></li>
<li class="toctree-l3"><a class="reference internal" href="motors.html">电机</a></li>
<li class="toctree-l3"><a class="reference internal" href="multitasking.html">多任务</a></li>
<li class="toctree-l3"><a class="reference internal" href="notifications.html">任务通知</a></li>
<li class="toctree-l3"><a class="reference internal" href="vision.html">视觉传感器</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">无线上传及冷热插拔</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">大型项目</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">冷热插拔疑难解答</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API 主页</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/c/index.html">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/cpp/index.html">C++ API</a></li>
</ul>
<p class="caption"><span class="caption-text">工具</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../editor/index.html">编辑器</a></li>
</ul>
<p class="caption"><span class="caption-text">OkapiLib</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../okapi/index.html">OkapiLib 文档主页</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../okapi/tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../okapi/api/index.html">OkapiLib API</a></li>
</ul>
<p class="caption"><span class="caption-text">扩展（高级用户）</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../extended/index.html">Extended API Topics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PROS for V5（中文）</a>
        
      </nav>


      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">教程</a> &raquo;</li>
        
      <li>无线上传及冷热插拔</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/MechDancer/pros-docs/blob/master/v5-chinese/tutorials/topical/wireless-upload.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>无线上传及冷热插拔<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Wireless Upload requires at least CLI 3.1.4, Kernel 3.1.6, VEXos 1.0.5, and OkapiLib 3.3.12 (if used).</p>
</div>
<p>PROS supports wireless upload to the V5 Brain via a V5 Controller. Although there are no special requirements to
enable PROS to do this, file transfer speeds are typically unacceptably slow. To make them more reasonable, PROS
has a different method of compiling your project so that the PROS kernel and other infrequently modified code
are uploaded once and only the code you regularly modify (e.g. opcontrol.cpp, autonomous.cpp, and initialize.cpp)
gets transferred to the V5 wirelessly. We call the code you upload once and never change the “cold image” and the
code that changes frequently and gets uploaded every time the “hot image.”</p>
<p>To enable this compilation mode, you should open your project’s Makefile and edit the line:</p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="c"># Set to 1 to enable hot/cold linking</span>
<span class="nv">USE_PACKAGE</span><span class="o">:=</span><span class="m">0</span>
</pre></div>
</div>
<p>so that <code class="docutils literal notranslate"><span class="pre">USE_PACKAGE:=1</span></code>. Re-build and upload your project and PROS will automatically use the new files. PROS
will automatically detect when you’re using the same combination of libraries and decide not to re-upload the
“cold” code. Verification that the library is present is done with filename and checksum of the file. As a result,
if you use the same combination of libraries (cold image), only one copy of the cold iamge is uploaded to the V5.</p>
<div class="section" id="id2">
<h2>大型项目<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>Projects with large codebases may still take some time to upload even with hot/cold linking. You may be able to
reduce the size of your hot image by making part of your project a library so that some code is included in the
cold image. To do so, edit the following lines of your project’s Makefile:</p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="c"># Set this to 1 to add additional rules to compile your project as a PROS library template</span>
<span class="nv">IS_LIBRARY</span><span class="o">:=</span><span class="m">0</span>
<span class="c"># TODO: CHANGE THIS!</span>
<span class="nv">LIBNAME</span><span class="o">:=</span>libbest
<span class="nv">VERSION</span><span class="o">:=</span><span class="m">1</span>.0.0
<span class="c"># EXCLUDE_SRC_FROM_LIB= $(SRCDIR)/unpublishedfile.c</span>
</pre></div>
</div>
<p>Change <code class="docutils literal notranslate"><span class="pre">IS_LIBRARY</span></code> to <code class="docutils literal notranslate"><span class="pre">1</span></code> and rename the library to something of your choosing. We recommend <code class="docutils literal notranslate"><span class="pre">lib&lt;robot</span> <span class="pre">name&gt;</span></code>
or <code class="docutils literal notranslate"><span class="pre">lib&lt;team</span> <span class="pre">number&gt;</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">lib7701</span></code>) to be unique enough to avoid cause naming conflicts with other cold
images. When compiling, PROS will include this library as part of the cold image. Your library should only contain
files you infrequently change so that you do not have to frequently upload the cold image. By default, the Makefile
is set up to exclude your project’s opcontrol.cpp, autonomous.cpp, and initialize.cpp files. If you change other
files frequently, you can add lines like <code class="docutils literal notranslate"><span class="pre">EXCLUDE_SRC_FROM_LIB+=$(SRCDIR)/myfile.c</span></code> as needed.</p>
<p><strong>An important caveat</strong> is that code that goes into the cold image is <strong>not</strong> able to link against anything (call
functions or use variables) in the hot image. Doing so will result in a linker error - you will be told what’s
trying to refer to what in the hot image:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>bin/libtheseus.a(lcdselector.cpp.o):(.data.inits+0x0): undefined reference to `auton::allianceInit(auton::color)&#39;
</pre></div>
</div>
<p>You should refactor your code so that only “hot” code calls “cold” code or include the culprit file in the hot image.</p>
<p>An example of a modified Makefile’s relevant lines is shown below:</p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="c"># Set to 1 to enable hot/cold linking</span>
<span class="nv">USE_PACKAGE</span><span class="o">=</span><span class="m">1</span>

<span class="c"># Set this to 1 to add additional rules to compile your project as a PROS library template</span>
<span class="nv">IS_LIBRARY</span><span class="o">:=</span><span class="m">1</span>
<span class="nv">LIBNAME</span><span class="o">:=</span>libtheseus
<span class="nv">VERSION</span><span class="o">:=</span><span class="m">1</span>.0.0
<span class="c"># this line excludes opcontrol.c and similar files</span>
<span class="nv">EXCLUDE_SRC_FROM_LIB</span><span class="o">+=</span><span class="k">$(</span>foreach file, <span class="k">$(</span>SRCDIR<span class="k">)</span>/opcontrol <span class="k">$(</span>SRCDIR<span class="k">)</span>/initialize <span class="k">$(</span>SRCDIR<span class="k">)</span>/autonomous,<span class="k">$(</span>foreach cext,<span class="k">$(</span>CEXTS<span class="k">)</span>,<span class="k">$(</span>file<span class="k">)</span>.<span class="k">$(</span>cext<span class="k">))</span> <span class="k">$(</span>foreach cxxext,<span class="k">$(</span>CXXEXTS<span class="k">)</span>,<span class="k">$(</span>file<span class="k">)</span>.<span class="k">$(</span>cxxext<span class="k">)))</span>
<span class="nv">EXCLUDE_SRC_FROM_LIB</span><span class="o">+=</span><span class="k">$(</span>SRCDIR<span class="k">)</span>/scripts             <span class="c1"># exclude any files in the src/scripts directory</span>
<span class="nv">EXCLUDE_SRC_FROM_LIB</span><span class="o">+=</span><span class="k">$(</span>SRCDIR<span class="k">)</span>/lcdselector.cpp     <span class="c1"># exclude src/lcdselector.cpp</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2>冷热插拔疑难解答<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>Since hot/cold linking involves ensuring two compiled programs interact consistently, there may be additional runtime
issues running in this mode. This section serves as a guide for debugging these sorts of issues.</p>
<p>Generally, if the program appears to be running correctly (i.e. the screen shows), then the compilation mode worked
correctly and the error you’re experiencing is likely related to your code’s logic. If your code’s logic runs correctly
when not using hot/cold linking, contact us so we may assist in troubleshooting.</p>
<p>If you see a black scren, then PROS did not boot correctly.</p>
<ul class="simple">
<li>A global constructor is in an infinite loop or raised an exception.</li>
<li>See also troubleshooting steps below</li>
</ul>
<p>If you see a grey screen, then PROS booted correctly, but is not running your hot image.</p>
<ul class="simple">
<li>Delete all user programs, perform a clean build, and upload</li>
</ul>
<p>If you’re having issues, contact us so we may assist in troubleshooting.</p>
</div>
</div>

  <div class="section">
  
  
  </div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../api/index.html" class="btn btn-neutral float-right" title="API 主页" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="vision.html" class="btn btn-neutral" title="视觉传感器" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019 Purdue ACM SIGBots 根据 MPL 2.0 许可发布，MechDancer 译。

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Versions: </span>
      v: V5 (3.1.6)
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="../../index.html">V5</a></dd>
        
      </dl>
    </div>
  </div>


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>